(function(t){function e(e){for(var n,s,l=e[0],o=e[1],r=e[2],u=0,p=[];u<l.length;u++)s=l[u],Object.prototype.hasOwnProperty.call(c,s)&&c[s]&&p.push(c[s][0]),c[s]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n]);d&&d(e);while(p.length)p.shift()();return i.push.apply(i,r||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],n=!0,l=1;l<a.length;l++){var o=a[l];0!==c[o]&&(n=!1)}n&&(i.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},c={app:0},i=[];function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=e,l=l.slice();for(var r=0;r<l.length;r++)e(l[r]);var d=o;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"56d7":function(t,e,a){"use strict";a.r(e);var n=a("7a23");const c={id:"main"},i={class:"nav nav-tabs"},s={class:"nav-item dropdown"},l={class:"nav-link dropdown-toggle","data-toggle":"dropdown",href:"#"},o={class:"dropdown-menu"},r={class:"nav-item"},d={class:"nav-link active","data-toggle":"tab",href:"#settings"},u={class:"nav-item"},p={class:"nav-link",id:"nav_content","data-toggle":"tab",href:"#content_editor"},b={class:"nav-item"},f={class:"nav-link",id:"nav_metadata_editor","data-toggle":"tab",href:"#metadata_editor"},m={class:"nav-item"},j={class:"nav-link",id:"nav_preview","data-toggle":"tab",href:"#preview",onclick:"MapSourceName()"},O={class:"nav-item"},g={class:"nav-link","data-toggle":"tab",href:"#about"},v={id:"log",onclick:"ToggleLog()"},h={class:"tab-content"},_={class:"tab-pane container active",id:"settings"},y={class:"tab-pane container fade",id:"content_editor"},k={class:"tab-pane container fade",id:"metadata_editor"},w={class:"tab-pane container fade",id:"preview"},x={class:"tab-pane container fade",id:"about"},C=Object(n["f"])("h2",null,"Manga Repack",-1),E={ref:"fileInput",type:"file",accept:".zip,.jpg,.jpeg,.png",multiple:"",style:{display:"none"}};function I(t,e,a,I,S,V){const D=Object(n["l"])("Settings"),L=Object(n["l"])("ContentEditor"),M=Object(n["l"])("MetadataEditor"),P=Object(n["l"])("Preview");return Object(n["g"])(),Object(n["c"])(n["a"],null,[Object(n["f"])("div",c,[Object(n["f"])("ul",i,[Object(n["f"])("li",s,[Object(n["f"])("a",l,Object(n["n"])(S.ui.menu_file),1),Object(n["f"])("div",o,[Object(n["f"])("a",{class:"dropdown-item",href:"#",onClick:e[1]||(e[1]=(...t)=>V.ImportZip&&V.ImportZip(...t))},Object(n["n"])(S.ui.menu_import),1),Object(n["f"])("a",{class:"dropdown-item",href:"#",onClick:e[2]||(e[2]=(...t)=>V.Save&&V.Save(...t))},Object(n["n"])(S.ui.menu_save),1)])]),Object(n["f"])("li",r,[Object(n["f"])("a",d,Object(n["n"])(S.ui.nav_settings),1)]),Object(n["f"])("li",u,[Object(n["f"])("a",p,Object(n["n"])(S.ui.nav_content),1)]),Object(n["f"])("li",b,[Object(n["f"])("a",f,Object(n["n"])(S.ui.nav_metadata),1)]),Object(n["f"])("li",m,[Object(n["f"])("a",j,Object(n["n"])(S.ui.nav_preview),1)]),Object(n["f"])("li",O,[Object(n["f"])("a",g,Object(n["n"])(S.ui.nav_about),1)]),Object(n["f"])("li",v,[(Object(n["g"])(!0),Object(n["c"])(n["a"],null,Object(n["j"])(S.log,t=>(Object(n["g"])(),Object(n["c"])(Object(n["m"])(t.type),{class:"alert alert-"+t.bsClass,time:t.time,key:t.id,logVar:S.logVar,title:t.content},{default:Object(n["q"])(()=>[Object(n["e"])(Object(n["n"])(t.content),1)]),_:2},1032,["class","time","logVar","title"]))),128))])]),Object(n["f"])("div",h,[Object(n["f"])("div",_,[Object(n["f"])(D,{ui:S.ui,sort:S.settings_sort,"onUpdate:sort":e[3]||(e[3]=t=>S.settings_sort=t),"zip-encoding":S.settings_zip_encoding,"onUpdate:zip-encoding":e[4]||(e[4]=t=>S.settings_zip_encoding=t),onChangeLang:e[5]||(e[5]=t=>S.ui=t)},null,8,["ui","sort","zip-encoding"])]),Object(n["f"])("div",y,[Object(n["f"])(L,{ui:S.ui,sources:S.sources},null,8,["ui","sources"])]),Object(n["f"])("div",k,[Object(n["f"])(M,{ref:"metadataEditor",ui:S.ui},null,8,["ui"])]),Object(n["f"])("div",w,[Object(n["f"])(P,{ui:S.ui,sources:S.sources,onSave:V.Save},null,8,["ui","sources","onSave"])]),Object(n["f"])("div",x,[C,Object(n["f"])("p",null,Object(n["n"])(S.ui.about_content),1)])])]),Object(n["f"])("input",E,null,512)],64)}const S=Object(n["s"])("data-v-3f3ed4cf"),V=S((t,e,a,c,i,s)=>(Object(n["g"])(),Object(n["c"])("p",null,[Object(n["e"])(Object(n["n"])(a.time)+": ",1),Object(n["k"])(t.$slots,"default",{},void 0,!0)])));var D={name:"LogMessage",props:{id:Number,time:String}};D.render=V,D.__scopeId="data-v-3f3ed4cf";var L=D;const M=Object(n["s"])("data-v-f0579de8"),P=M((t,e,a,c,i,s)=>(Object(n["g"])(),Object(n["c"])("p",null,[Object(n["e"])(Object(n["n"])(a.time)+": ",1),Object(n["k"])(t.$slots,"default",{},void 0,!0),Object(n["e"])(" "+Object(n["n"])(a.logVar),1)])));var z={name:"LogMessageVar",props:{id:Number,time:String,logVar:String}};z.render=P,z.__scopeId="data-v-f0579de8";var A=z;const U=Object(n["s"])("data-v-679232d6");Object(n["i"])("data-v-679232d6");const N={class:"p-3"},R={class:"form-group row"},W=Object(n["f"])("label",{class:"col-form-label col-3"},"Language",-1),B=Object(n["f"])("option",{value:"zh-CN"},"简体中文",-1),F=Object(n["f"])("option",{value:"en"},"English",-1),q={class:"form-group row"},Z={for:"settings_zip_encoding",class:"col-form-label col-3"},G=Object(n["f"])("option",null,"utf-8",-1),T=Object(n["f"])("option",null,"shift-jis",-1),J=Object(n["f"])("option",null,"gbk",-1),X=Object(n["f"])("option",null,"big5",-1),H={class:"form-group row"},K={for:"settings_sort",class:"col-form-label col-3"},Q={value:"SortByFullPath"},Y={value:"SortByFileName"};Object(n["h"])();const tt=U((t,e,a,c,i,s)=>(Object(n["g"])(),Object(n["c"])("form",N,[Object(n["f"])("div",R,[W,Object(n["r"])(Object(n["f"])("select",{class:"form-control col-3","onUpdate:modelValue":e[1]||(e[1]=t=>s.lang=t)},[B,F],512),[[n["o"],s.lang]])]),Object(n["f"])("div",q,[Object(n["f"])("label",Z,Object(n["n"])(a.ui.settings_zip_encoding),1),Object(n["f"])("select",{class:"form-control col-3",id:"settings_zip_encoding",value:a.zipEncoding,onInput:e[2]||(e[2]=e=>t.$emit("update:zipEncoding",e.target.value))},[G,T,J,X],40,["value"])]),Object(n["f"])("div",H,[Object(n["f"])("label",K,Object(n["n"])(a.ui.settings_sort),1),Object(n["f"])("select",{class:"form-control col-3",id:"settings_sort",value:a.sort,onInput:e[3]||(e[3]=e=>t.$emit("update:sort",e.target.value))},[Object(n["f"])("option",Q,Object(n["n"])(a.ui.settings_SortByFullPath),1),Object(n["f"])("option",Y,Object(n["n"])(a.ui.settings_SortByFileName),1)],40,["value"])])])));var et={name:"Settings",props:{ui:Object,sort:String,zipEncoding:String},emits:["changeLang","update:zipEncoding","update:sort"],data(){return{}},computed:{lang:{get(){return this.ui.nav_settings==locale_zhCN.nav_settings?"zh-CN":this.ui.nav_settings==locale_en.nav_settings?"en":void 0},set(t){let e=locale_en;switch(t){case"zh-CN":e=locale_zhCN;break;case"en":break}this.$emit("changeLang",e)}}}};et.render=tt,et.__scopeId="data-v-679232d6";var at=et;const nt=Object(n["s"])("data-v-1fcf46ed");Object(n["i"])("data-v-1fcf46ed");const ct={id:"pageListWarpper",ref:"pageList"},it={class:"short_filename"},st={id:"editorZone"},lt={id:"pageViewerWarpper"},ot={id:"pageViewer",ref:"pageViewer"},rt={class:"nav-item"},dt={class:"nav-item"},ut={class:"nav-link","data-toggle":"tab",href:"#tocEntryRight",id:"nav_tocEntryRight"},pt={class:"nav-item"},bt={class:"nav-item"},ft={class:"nav-link","data-toggle":"tab",href:"#tocEntryLeft",id:"nav_tocEntryLeft"},mt={class:"tab-content"},jt={class:"tab-pane container",id:"tocEntryLeft"},Ot={class:"input-group mb-3 w-50"},gt={class:"input-group-prepend"},vt={class:"input-group-text alert-primary"},ht=Object(n["d"])('<option value="none" data-v-1fcf46ed>- - -</option><option value="cover" data-v-1fcf46ed>表紙</option><option value="toc" data-v-1fcf46ed>目次</option><option value="bodymatter" data-v-1fcf46ed>本編</option><option value="colophon" data-v-1fcf46ed>奥付</option>',5),_t={class:"input-group mb-3 w-50"},yt={class:"input-group-prepend"},kt={class:"input-group-text alert-success"},wt={class:"input-group mb-3"},xt={class:"tab-pane container",id:"tocEntryRight"},Ct={class:"input-group mb-3 w-50"},Et={class:"input-group-prepend"},It={class:"input-group-text alert-primary"},St=Object(n["d"])('<option value="none" data-v-1fcf46ed>- - -</option><option value="cover" data-v-1fcf46ed>表紙</option><option value="toc" data-v-1fcf46ed>目次</option><option value="bodymatter" data-v-1fcf46ed>本編</option><option value="colophon" data-v-1fcf46ed>奥付</option>',5),Vt={class:"input-group mb-3 w-50"},Dt={class:"input-group-prepend"},Lt={class:"input-group-text alert-success"},Mt={class:"input-group mb-3"};Object(n["h"])();const Pt=nt((t,e,a,c,i,s)=>(Object(n["g"])(),Object(n["c"])(n["a"],null,[Object(n["f"])("div",ct,[(Object(n["g"])(!0),Object(n["c"])(n["a"],null,Object(n["j"])(a.sources,(t,e)=>(Object(n["g"])(),Object(n["c"])("div",{class:"pageListItem",key:t,onClick:e=>s.ClickItem(t),"data-select":-1==i.selected?"no-select":0==i.selected?0==e?"cover":"none":i.selected==e?"right":e==i.selected+1?"left":"none"},[Object(n["f"])("img",{src:t.thumbURL},null,8,["src"]),Object(n["f"])("label",it,[Object(n["f"])("span",null,Object(n["n"])(t.filename),1)]),Object(n["f"])("div",{class:"landmark_label","data-display":t.landmark?"true":""},[Object(n["f"])("span",{class:"alert-primary",title:t.landmark},Object(n["n"])(t.landmark),9,["title"])],8,["data-display"]),Object(n["f"])("div",{class:"toc_label","data-display":t.toc?"true":""},[Object(n["f"])("span",{class:"alert-success",title:t.toc},Object(n["n"])(t.toc),9,["title"])],8,["data-display"])],8,["onClick","data-select"]))),128))],512),Object(n["f"])("div",st,[Object(n["f"])("div",lt,[Object(n["f"])("canvas",ot,null,512)]),Object(n["f"])("ul",{class:"nav nav-tabs",id:"pageEditor","data-sp":i.pageEditorSp},[Object(n["f"])("li",rt,[Object(n["f"])("a",{class:"nav-link",href:"#",onClick:e[1]||(e[1]=t=>s.AddPlaceholder(0))},Object(n["n"])(a.ui.editor_add_placeholder),1)]),Object(n["f"])("li",dt,[Object(n["f"])("a",ut,Object(n["n"])(a.ui.editor_edit_this_page),1)]),Object(n["f"])("li",pt,[Object(n["f"])("a",{class:"nav-link",href:"#",onClick:e[2]||(e[2]=t=>s.AddPlaceholder(1))},Object(n["n"])(a.ui.editor_add_placeholder),1)]),Object(n["f"])("li",bt,[Object(n["f"])("a",ft,Object(n["n"])(a.ui.editor_edit_this_page),1)])],8,["data-sp"]),Object(n["f"])("div",mt,[Object(n["f"])("div",jt,[Object(n["f"])("label",null,Object(n["n"])(s.navEditorL_filename),1),Object(n["f"])("div",Ot,[Object(n["f"])("div",gt,[Object(n["f"])("label",vt,Object(n["n"])(a.ui.editor_guide),1)]),Object(n["r"])(Object(n["f"])("select",{class:"custom-select","onUpdate:modelValue":e[3]||(e[3]=t=>s.navEditorL_landmark=t),onblur:"logValueChangeEnd()"},[ht],512),[[n["o"],s.navEditorL_landmark]])]),Object(n["f"])("div",_t,[Object(n["f"])("div",yt,[Object(n["f"])("span",kt,Object(n["n"])(a.ui.editor_toc_entry),1)]),Object(n["r"])(Object(n["f"])("input",{type:"text",class:"form-control",placeholder:"- - -","onUpdate:modelValue":e[4]||(e[4]=t=>s.navEditorL_toc=t),onblur:"logValueChangeEnd()"},null,512),[[n["p"],s.navEditorL_toc]])]),Object(n["f"])("div",wt,[Object(n["f"])("button",{class:"btn btn-outline-danger",type:"button",onClick:e[5]||(e[5]=t=>s.DeletePage(1))},Object(n["n"])(a.ui.editor_delete_page),1)])]),Object(n["f"])("div",xt,[Object(n["f"])("label",null,Object(n["n"])(s.navEditorR_filename),1),Object(n["f"])("div",Ct,[Object(n["f"])("div",Et,[Object(n["f"])("label",It,Object(n["n"])(a.ui.editor_guide),1)]),Object(n["r"])(Object(n["f"])("select",{class:"custom-select","onUpdate:modelValue":e[6]||(e[6]=t=>s.navEditorR_landmark=t),onblur:"logValueChangeEnd()"},[St],512),[[n["o"],s.navEditorR_landmark]])]),Object(n["f"])("div",Vt,[Object(n["f"])("div",Dt,[Object(n["f"])("span",Lt,Object(n["n"])(a.ui.editor_toc_entry),1)]),Object(n["r"])(Object(n["f"])("input",{type:"text",class:"form-control",placeholder:"- - -","onUpdate:modelValue":e[7]||(e[7]=t=>s.navEditorR_toc=t),onblur:"logValueChangeEnd()"},null,512),[[n["p"],s.navEditorR_toc]])]),Object(n["f"])("div",Mt,[Object(n["f"])("button",{class:"btn btn-outline-danger",type:"button",onClick:e[8]||(e[8]=t=>s.DeletePage(0))},Object(n["n"])(a.ui.editor_delete_page),1)])])])])],64)));var zt={name:"ContentEditor",props:{ui:Object,sources:Array},emits:[],data(){return{selected:-1,pageEditorSp:""}},mounted(){Split(["#pageListWarpper","#editorZone"],{sizes:[30,70]});let t=this.$refs.pageViewer;t.width=window.innerWidth,t.height=t.width/2*ratio},computed:{navEditorR_filename(){if(!(this.selected<0))return this.sources[this.selected].filename},navEditorR_landmark:{get(){if(this.selected<0)return;let t=this.sources[this.selected].landmark;return t||"none"},set(t){if(this.selected<0)return;let e=this.sources[this.selected];logValueChange("landmark of ",e,e.landmark,t),"none"==t&&(t=""),e.landmark=t}},navEditorR_toc:{get(){if(this.selected<0)return;let t=this.sources[this.selected].toc;return t||""},set(t){if(this.selected<0)return;let e=this.sources[this.selected];logValueChange("toc of ",e,e.toc,t),e.toc=t}},navEditorL_filename(){if(!(this.selected+1>=this.sources.length))return this.sources[this.selected+1].filename},navEditorL_landmark:{get(){if(this.selected+1>=this.sources.length)return;let t=this.sources[this.selected+1].landmark;return t||"none"},set(t){if(this.selected+1>=this.sources.length)return;let e=this.sources[this.selected+1];logValueChange("landmark of ",e,e.landmark,t),"none"==t&&(t=""),e.landmark=t}},navEditorL_toc:{get(){if(this.selected+1>=this.sources.length)return;let t=this.sources[this.selected+1].toc;return t||""},set(t){if(this.selected+1>=this.sources.length)return;let e=this.sources[this.selected+1];logValueChange("toc of ",e,e.toc,t),e.toc=t}}},methods:{ClickItem(t){let e=this.sources.indexOf(t);this.ActivePage(e)},ActivePage(t){if(0==t)this.selected=0,this.pageEditorSp="cover";else{let e,a;t%2==0?(a=t,e=a-1):(e=t,a=e+1),this.selected=e,this.pageEditorSp="",e+1==this.sources.length&&(this.pageEditorSp="single")}let e=this.$refs.pageViewer,a=e.getContext("2d");if(a.clearRect(0,0,e.width,e.height),0==this.selected){let t=this.sources[0].image,n=FitImage(t,e.width,e.height);a.drawImage(t,n[0],n[1],n[2],n[3])}else{{let t=this.sources[this.selected].image,n=FitImage(t,e.width/2,e.height);a.drawImage(t,e.width/2,n[1],n[2],n[3])}if(this.selected+1<this.sources.length){let t=this.sources[this.selected+1].image,n=FitImage(t,e.width/2,e.height);n[0]>0&&(n[0]=e.width/2-n[2]),a.drawImage(t,n[0],n[1],n[2],n[3])}}0==t?document.querySelector("#nav_tocEntryRight").click():t%2==0?document.querySelector("#nav_tocEntryLeft").click():document.querySelector("#nav_tocEntryRight").click()},AddPlaceholder(t){if(this.selected<0)return;if(this.selected+t>=this.sources.length)return;let e=CreateSourcePlaceholder(this.sources[this.selected+t-1]);this.sources.splice(this.selected+t,0,e),this.ActivePage(this.selected+t),log("Placeholder inserted.")},DeletePage(t){if(this.selected<0)return;if(this.selected+t>=this.sources.length)return;let e=this.sources[this.selected+t];this.sources.splice(this.selected+t,1),this.ActivePage(this.selected+t),"placeholder"==e.from?log("Delete placeholder: "+e.filename):log("Delete page: "+e.filename)}}};zt.render=Pt,zt.__scopeId="data-v-1fcf46ed";var At=zt;const Ut=Object(n["s"])("data-v-59e4276e");Object(n["i"])("data-v-59e4276e");const $t={class:"p-3"},Nt={class:"input-group mb-3 w-25"},Rt={class:"input-group-prepend"},Wt={class:"input-group-text",for:"metadata_language"},Bt=Object(n["f"])("option",null,"ja",-1),Ft=Object(n["f"])("option",null,"zh-CN",-1),qt=Object(n["f"])("option",null,"zh-TW",-1),Zt={class:"input-group mb-3"},Gt={class:"input-group-prepend"},Tt={class:"input-group-text",id:"basic-addon1"},Jt={class:"input-group-prepend"},Xt={class:"nav-item dropdown mb-3"},Ht={type:"button",class:"btn btn-primary dropdown-toggle","data-toggle":"dropdown"},Kt={class:"dropdown-menu"},Qt={id:"metadata_editor_optional"};Object(n["h"])();const Yt=Ut((t,e,a,c,i,s)=>(Object(n["g"])(),Object(n["c"])("form",$t,[Object(n["f"])("div",Nt,[Object(n["f"])("div",Rt,[Object(n["f"])("label",Wt,Object(n["n"])(a.ui.metadata_language),1)]),Object(n["r"])(Object(n["f"])("select",{class:"custom-select",id:"metadata_language","onUpdate:modelValue":e[1]||(e[1]=t=>i.language=t)},[Bt,Ft,qt],512),[[n["o"],i.language]])]),Object(n["f"])("div",Zt,[Object(n["f"])("div",Gt,[Object(n["f"])("span",Tt,Object(n["n"])(a.ui.metadata_title),1)]),Object(n["r"])(Object(n["f"])("input",{type:"text",class:"form-control",placeholder:"","onUpdate:modelValue":e[2]||(e[2]=t=>i.title=t)},null,512),[[n["p"],i.title]]),Object(n["f"])("div",Jt,[Object(n["f"])("label",{class:"input-group-text",for:"file-as","data-toggle":"tooltip",title:a.ui.metadata_file_as_tip},Object(n["n"])(a.ui.metadata_file_as),9,["title"])]),Object(n["r"])(Object(n["f"])("input",{type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=t=>i.title_file_as=t)},null,512),[[n["p"],i.title_file_as]])]),Object(n["f"])("div",Xt,[Object(n["f"])("button",Ht,Object(n["n"])(a.ui.metadata_add_optional),1),Object(n["f"])("div",Kt,[Object(n["f"])("a",{class:"dropdown-item",href:"#",onClick:e[4]||(e[4]=t=>s.AddMetadataInput("metadata-input-creator"))},Object(n["n"])(a.ui.metadata_creator),1),Object(n["f"])("a",{class:"dropdown-item",href:"#",onClick:e[5]||(e[5]=t=>s.AddMetadataInput("metadata-input-date")),"data-toggle":"tooltip","data-placement":"right",title:a.ui.metadata_onlyone,"data-dropdown-item-disable":s.containsDate},Object(n["n"])(a.ui.metadata_date),9,["title","data-dropdown-item-disable"]),Object(n["f"])("a",{class:"dropdown-item",href:"#",onClick:e[6]||(e[6]=t=>s.AddMetadataInput("metadata-input-publisher"))},Object(n["n"])(a.ui.metadata_publisher),1),Object(n["f"])("a",{class:"dropdown-item",href:"#",onClick:e[7]||(e[7]=t=>s.AddMetadataInput("metadata-input-source"))},Object(n["n"])(a.ui.metadata_source),1),Object(n["f"])("a",{class:"dropdown-item",href:"#",onClick:e[8]||(e[8]=t=>s.AddMetadataInput("metadata-input-description"))},Object(n["n"])(a.ui.metadata_description),1),Object(n["f"])("a",{class:"dropdown-item",href:"#",onClick:e[9]||(e[9]=t=>s.AddMetadataInput("metadata-input-general"))},Object(n["n"])(a.ui.metadata_meta),1)])]),Object(n["f"])("div",Qt,[(Object(n["g"])(!0),Object(n["c"])(n["a"],null,Object(n["j"])(i.inputs,t=>(Object(n["g"])(),Object(n["c"])(Object(n["m"])(t.type),{ui:a.ui,id:t.id,key:t.id,inputs:i.inputs,onDestory:e[10]||(e[10]=t=>s.DestoryMetadataInput(t))},null,8,["ui","id","inputs"]))),128))])]))),te=Object(n["s"])("data-v-4d9221c3");Object(n["i"])("data-v-4d9221c3");const ee={class:"input-group mb-3"},ae={class:"input-group-prepend"},ne={class:"input-group-text"},ce={class:"input-group-prepend"},ie={class:"input-group-append"};Object(n["h"])();const se=te((t,e,a,c,i,s)=>(Object(n["g"])(),Object(n["c"])("div",ee,[Object(n["f"])("div",ae,[Object(n["f"])("span",ne,Object(n["n"])(a.ui.metadata_creator),1)]),Object(n["r"])(Object(n["f"])("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=t=>i.t_value=t)},null,512),[[n["p"],i.t_value]]),Object(n["f"])("div",ce,[Object(n["f"])("label",{class:"input-group-text","data-toggle":"tooltip",title:a.ui.metadata_file_as_tip},Object(n["n"])(a.ui.metadata_file_as),9,["title"])]),Object(n["r"])(Object(n["f"])("input",{type:"text",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=t=>i.t_file_as=t)},null,512),[[n["p"],i.t_file_as]]),Object(n["f"])("div",ie,[Object(n["f"])("button",{class:"btn btn-outline-danger",type:"button",onClick:e[3]||(e[3]=(...t)=>s.Destory&&s.Destory(...t))},Object(n["n"])(a.ui.metadata_delete),1)]),Object(n["f"])("div",{class:"metadata-output","data-xml":s.xml},null,8,["data-xml"])])));var le={name:"metadata-input-creator",props:{id:Number,ui:Object,inputs:Array},data(){return{t_value:"",t_file_as:""}},methods:{Destory(){console.log(this.xml),this.$emit("destory",this.id)}},computed:{xml(){let t="",e=0;for(const a of this.inputs){if(this.id==a.id)break;"metadata-input-creator"==a.type&&e++}return e="creator"+e,""!=this.t_value&&(t+='    <dc:creator id="'+e+'">'+this.t_value+"</dc:creator>\n"),""!=this.t_file_as&&(t+='    <meta property="file-as" refines="#'+e+'">'+this.t_file_as+"</meta>\n"),t}}};le.render=se,le.__scopeId="data-v-4d9221c3";var oe=le;const re=Object(n["s"])("data-v-f972fbae");Object(n["i"])("data-v-f972fbae");const de={class:"input-group mb-3"},ue={class:"input-group-prepend"},pe={class:"input-group-text"},be={class:"input-group-append"};Object(n["h"])();const fe=re((t,e,a,c,i,s)=>(Object(n["g"])(),Object(n["c"])("div",de,[Object(n["f"])("div",ue,[Object(n["f"])("label",pe,Object(n["n"])(a.ui.metadata_date),1)]),Object(n["r"])(Object(n["f"])("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=t=>i.t_value=t)},null,512),[[n["p"],i.t_value]]),Object(n["f"])("div",be,[Object(n["f"])("button",{class:"btn btn-outline-danger",type:"button",onClick:e[2]||(e[2]=(...t)=>s.Destory&&s.Destory(...t))},Object(n["n"])(a.ui.metadata_delete),1)]),Object(n["f"])("div",{class:"metadata-output","data-xml":s.xml},null,8,["data-xml"])])));var me={name:"metadata-input-date",props:{id:Number,ui:Object},data(){return{t_value:(new Date).toISOString()}},methods:{Destory(){console.log(this.xml),this.$emit("destory",this.id)}},computed:{xml(){let t="";return""!=this.t_value&&(t+="    <dc:date>"+this.t_value+"</dc:date>\n"),t}}};me.render=fe,me.__scopeId="data-v-f972fbae";var je=me;const Oe=Object(n["s"])("data-v-e89c835a");Object(n["i"])("data-v-e89c835a");const ge={class:"input-group mb-3"},ve={class:"input-group-prepend"},he={class:"input-group-text"},_e={class:"input-group-prepend"},ye={class:"input-group-append"};Object(n["h"])();const ke=Oe((t,e,a,c,i,s)=>(Object(n["g"])(),Object(n["c"])("div",ge,[Object(n["f"])("div",ve,[Object(n["f"])("span",he,Object(n["n"])(a.ui.metadata_publisher),1)]),Object(n["r"])(Object(n["f"])("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=t=>i.t_value=t)},null,512),[[n["p"],i.t_value]]),Object(n["f"])("div",_e,[Object(n["f"])("label",{class:"input-group-text","data-toggle":"tooltip",title:a.ui.metadata_file_as_tip},Object(n["n"])(a.ui.metadata_file_as),9,["title"])]),Object(n["r"])(Object(n["f"])("input",{type:"text",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=t=>i.t_file_as=t)},null,512),[[n["p"],i.t_file_as]]),Object(n["f"])("div",ye,[Object(n["f"])("button",{class:"btn btn-outline-danger",type:"button",onClick:e[3]||(e[3]=(...t)=>s.Destory&&s.Destory(...t))},Object(n["n"])(a.ui.metadata_delete),1)]),Object(n["f"])("div",{class:"metadata-output","data-xml":s.xml},null,8,["data-xml"])])));var we={name:"metadata-input-publisher",props:{id:Number,ui:Object,inputs:Array},data(){return{t_value:"",t_file_as:""}},methods:{Destory(){console.log(this.xml),this.$emit("destory",this.id)}},computed:{xml(){let t="",e=0;for(const a of this.inputs){if(this.id==a.id)break;"metadata-input-publisher"==a.type&&e++}return e="publisher"+e,""!=this.t_value&&(t+='    <dc:publisher id="'+e+'">'+this.t_value+"</dc:publisher>\n"),""!=this.t_file_as&&(t+='    <meta property="file-as" refines="#'+e+'">'+this.t_file_as+"</meta>\n"),t}}};we.render=ke,we.__scopeId="data-v-e89c835a";var xe=we;const Ce=Object(n["s"])("data-v-9298a2f2");Object(n["i"])("data-v-9298a2f2");const Ee={class:"input-group mb-3"},Ie={class:"input-group-prepend"},Se={class:"input-group-text"},Ve={class:"input-group-append"};Object(n["h"])();const De=Ce((t,e,a,c,i,s)=>(Object(n["g"])(),Object(n["c"])("div",Ee,[Object(n["f"])("div",Ie,[Object(n["f"])("span",Se,Object(n["n"])(a.ui.metadata_source),1)]),Object(n["r"])(Object(n["f"])("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=t=>i.t_value=t)},null,512),[[n["p"],i.t_value]]),Object(n["f"])("div",Ve,[Object(n["f"])("button",{class:"btn btn-outline-danger",type:"button",onClick:e[2]||(e[2]=(...t)=>s.Destory&&s.Destory(...t))},Object(n["n"])(a.ui.metadata_delete),1)]),Object(n["f"])("div",{class:"metadata-output","data-xml":s.xml},null,8,["data-xml"])])));var Le={name:"metadata-input-source",props:{id:Number,ui:Object},data(){return{t_value:""}},methods:{Destory(){console.log(this.xml),this.$emit("destory",this.id)}},computed:{xml(){let t="";return""!=this.t_value&&(t+="    <dc:source>"+this.t_value+"</dc:source>\n"),t}}};Le.render=De,Le.__scopeId="data-v-9298a2f2";var Me=Le;const Pe=Object(n["s"])("data-v-93b4293e");Object(n["i"])("data-v-93b4293e");const ze={class:"input-group mb-3"},Ae={class:"input-group-prepend"},Ue={class:"input-group-text"},$e={class:"input-group-prepend"},Ne={class:"input-group-text"},Re={class:"input-group-prepend"},We={class:"input-group-text"},Be={class:"input-group-append"};Object(n["h"])();const Fe=Pe((t,e,a,c,i,s)=>(Object(n["g"])(),Object(n["c"])("div",ze,[Object(n["f"])("div",Ae,[Object(n["f"])("span",Ue,Object(n["n"])(a.ui.metadata_meta),1)]),Object(n["f"])("div",$e,[Object(n["f"])("span",Ne,Object(n["n"])(a.ui.metadata_meta_property),1)]),Object(n["r"])(Object(n["f"])("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=t=>i.t_property=t)},null,512),[[n["p"],i.t_property]]),Object(n["f"])("div",Re,[Object(n["f"])("label",We,Object(n["n"])(a.ui.metadata_meta_value),1)]),Object(n["r"])(Object(n["f"])("input",{type:"text",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=t=>i.t_value=t)},null,512),[[n["p"],i.t_value]]),Object(n["f"])("div",Be,[Object(n["f"])("button",{class:"btn btn-outline-danger",type:"button",onClick:e[3]||(e[3]=(...t)=>s.Destory&&s.Destory(...t))},Object(n["n"])(a.ui.metadata_delete),1)]),Object(n["f"])("div",{class:"metadata-output","data-xml":s.xml},null,8,["data-xml"])])));var qe={name:"metadata-input-general",props:{id:Number,ui:Object},data(){return{t_value:"",t_property:""}},methods:{Destory(){console.log(this.xml),this.$emit("destory",this.id)}},computed:{xml(){if(""!=this.t_property&&""!=this.t_value)return'    <meta property="'+this.t_property+'">'+this.t_value+"</meta>\n"}}};qe.render=Fe,qe.__scopeId="data-v-93b4293e";var Ze=qe;const Ge=Object(n["s"])("data-v-18b21548");Object(n["i"])("data-v-18b21548");const Te={class:"input-group mb-3"},Je={class:"input-group-prepend"},Xe={class:"input-group-text"},He={class:"input-group-append"};Object(n["h"])();const Ke=Ge((t,e,a,c,i,s)=>(Object(n["g"])(),Object(n["c"])("div",Te,[Object(n["f"])("div",Je,[Object(n["f"])("span",Xe,Object(n["n"])(a.ui.metadata_description),1)]),Object(n["r"])(Object(n["f"])("textarea",{class:"form-control","onUpdate:modelValue":e[1]||(e[1]=t=>i.t_value=t)},null,512),[[n["p"],i.t_value]]),Object(n["f"])("div",He,[Object(n["f"])("button",{class:"btn btn-outline-danger",type:"button",onClick:e[2]||(e[2]=(...t)=>s.Destory&&s.Destory(...t))},Object(n["n"])(a.ui.metadata_delete),1)]),Object(n["f"])("div",{class:"metadata-output","data-xml":s.xml},null,8,["data-xml"])])));var Qe={name:"metadata-input-description",props:{id:Number,ui:Object},data(){return{t_value:""}},methods:{Destory(){console.log(this.xml),this.$emit("destory",this.id)}},computed:{xml(){let t="";return""!=this.t_value&&(t+="    <dc:description>"+this.t_value+"</dc:description>\n"),t}}};Qe.render=Ke,Qe.__scopeId="data-v-18b21548";var Ye=Qe,ta={name:"MetadataEditor",components:{MetadataInputCreator:oe,MetadataInputDate:je,MetadataInputPublisher:xe,MetadataInputSource:Me,MetadataInputDescription:Ye,MetadataInputGeneral:Ze},props:{ui:Object},emits:[],data(){return{title:"",title_file_as:"",language:"ja",inputs:[]}},mounted(){},computed:{containsDate(){for(const t of this.inputs)if("metadata-input-date"==t.type)return!0;return!1}},methods:{AddMetadataInput(t){"metadata-input-date"==t&&this.metadataContainsDate||(this.inputs.push({id:GenarateId(),type:t}),console.log(this.inputs))},DestoryMetadataInput(t){let e=0;for(const a of this.inputs){if(t==a.id)break;e++}e<this.inputs.length&&this.inputs.splice(e,1)},GetMetadataXml(){let t=document.getElementById("metadata_editor_optional"),e='    <dc:title id="title">'+this.title+"</dc:title>\n";""!=this.title_file_as&&(e+='    <meta property="file-as" refines="#title">'+this.title_file_as+"</meta>\n"),e+="    <dc:language>"+this.language+"</dc:language>\n";for(const a of t.getElementsByClassName("metadata-output"))e+=a.getAttribute("data-xml");return e}}};ta.render=Yt,ta.__scopeId="data-v-59e4276e";var ea=ta;const aa=Object(n["s"])("data-v-4a093c70");Object(n["i"])("data-v-4a093c70");const na={id:"previewNav",ref:"pageList"},ca={class:"short_filename"},ia={class:"alert-primary"},sa={class:"alert-success"},la={id:"previewData"},oa={class:"input-group"};Object(n["h"])();const ra=aa((t,e,a,c,i,s)=>(Object(n["g"])(),Object(n["c"])(n["a"],null,[Object(n["f"])("div",na,[(Object(n["g"])(!0),Object(n["c"])(n["a"],null,Object(n["j"])(a.sources,t=>(Object(n["g"])(),Object(n["c"])("div",{class:"pageListItem",key:t,"data-display":t.toc||t.landmark?"":"none"},[Object(n["f"])("img",{src:t.thumbURL},null,8,["src"]),Object(n["f"])("label",ca,[Object(n["f"])("span",{title:t.filename},Object(n["n"])(t.filename),9,["title"])]),Object(n["f"])("div",{class:"landmark_label","data-display":t.landmark?"true":""},[Object(n["f"])("span",ia,Object(n["n"])(t.landmark),1)],8,["data-display"]),Object(n["f"])("div",{class:"toc_label","data-display":t.toc?"true":""},[Object(n["f"])("span",sa,Object(n["n"])(t.toc),1)],8,["data-display"])],8,["data-display"]))),128))],512),Object(n["f"])("div",la,[Object(n["f"])("div",oa,[Object(n["f"])("button",{class:"btn",type:"button",onClick:e[1]||(e[1]=e=>t.$emit("save"))},Object(n["n"])(a.ui.menu_save),1)])])],64)));var da={name:"Preview",props:{ui:Object,sources:Array},emits:["save"]};da.render=ra,da.__scopeId="data-v-4a093c70";var ua=da,pa={name:"App",components:{LogMessage:L,LogMessageVar:A,Settings:at,ContentEditor:At,MetadataEditor:ea,Preview:ua},data(){return{ui:GetUserLocale(),log:[],logVar:"",sources:[],source_commonPath:"",settings_sort:"SortByFullPath",settings_zip_encoding:"shift-jis"}},computed:{},mounted(){vm=this,$(document).ready((function(){$('[data-toggle="tooltip"]').tooltip()})),this.$refs.fileInput.onchange=function(){document.body.setAttribute("data-state","loading"),ba(vm.$refs.fileInput.files).then(()=>{document.body.setAttribute("data-state",""),log(vm.ui.msg_imported,"success")})}},methods:{ImportZip(){this.$refs.fileInput.click(),document.querySelector("#nav_content").click()},Save(){if(0!=this.sources.length){if(!CheckInputValid())return document.querySelector("#nav_metadata_editor"),void log("metadata not complete!","danger");document.querySelector("#nav_preview").click(),SaveEpub()}else log("No content!","danger")}}};async function ba(t){for(const a of t){if(logValueChange("input count",null,0,vm.sources.length+""),a.name.endsWith(".zip")){const t=new zip.ZipReader(new zip.BlobReader(a),{filenameEncoding:vm.settings_zip_encoding}),e=await t.getEntries();for(const n of e){if(n.filename.endsWith(".jpg")){const t=await n.getData(new zip.BlobWriter("image/jpeg"));vm.sources.push(await CreateSource(t,a.name+"/"+n.filename,"archive"))}if(n.filename.endsWith(".png")){const t=await n.getData(new zip.BlobWriter("image/png"));vm.sources.push(await CreateSource(t,a.name+"/"+n.filename,"archive"))}logValueChange("input count",null,0,vm.sources.length+"")}await t.close()}(a.name.endsWith(".jpg")||a.name.endsWith(".png"))&&vm.sources.push(await CreateSource(a,a.name,"file"))}if(0==vm.sources.length)return;let e=vm.sources[0].filename;for(const a of vm.sources)e=StringCommonStart(e,a.filename);vm.sources[0].toc="Cover",vm.sources[0].landmark="cover",vm.source_commonPath=e,""==vm.$refs.metadataEditor.title&&(vm.$refs.metadataEditor.title=e.replaceAll("/"," ")),vm.sources.sort(sortSourceByFullPath),logValueChange("input count",null,0,vm.sources.length+""),logValueChangeEnd()}pa.render=I;var fa=pa;Object(n["b"])(fa).mount("#app")}});
//# sourceMappingURL=app.0c5888e4.js.map